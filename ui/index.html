<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DeepForensics Local Demo</title>
    <style>
      :root { --bg:#0b1220; --card:#121a2b; --muted:#8892a6; --accent:#4f8cff; --ok:#19c37d; --warn:#ffb020; --bad:#ff5470; }
      *{box-sizing:border-box}
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; background:var(--bg); color:#e6edf3; }
      header { padding:16px 24px; border-bottom:1px solid #1f2a44; display:flex; justify-content:space-between; align-items:center; }
      header h1 { font-size:18px; margin:0; letter-spacing:.3px; }
      .chip { border:1px solid #1f2a44; background:#0c1528; padding:6px 10px; border-radius:999px; font-size:12px; color:var(--muted); }
      main { max-width:1100px; margin:24px auto; padding:0 16px; display:grid; grid-template-columns: 360px 1fr; gap:16px; }
      @media (max-width: 960px){ main{ grid-template-columns: 1fr; } }
      .card { background:var(--card); border:1px solid #1f2a44; border-radius:12px; padding:16px; }
      .muted { color:var(--muted); font-size:13px; }
      .row { display:flex; gap:12px; align-items:center; }
      .btn { background:var(--accent); color:white; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600; }
      .btn:disabled { opacity:.6; cursor:not-allowed }
      input[type="file"] { width:100%; }
      label { font-size:14px; }
      .stats { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; margin-top:8px; }
      .stat { background:#0c1528; border:1px solid #1f2a44; border-radius:10px; padding:12px; }
      .stat .k { font-size:12px; color:var(--muted); }
      .stat .v { font-size:18px; font-weight:700; margin-top:2px; }
      .badge { display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; font-weight:600; }
      .badge.ok { background:rgba(25,195,125,.12); color:#19c37d; border:1px solid rgba(25,195,125,.3) }
      .badge.warn { background:rgba(255,176,32,.12); color:#ffb020; border:1px solid rgba(255,176,32,.3) }
      .badge.bad { background:rgba(255,84,112,.12); color:#ff5470; border:1px solid rgba(255,84,112,.3) }
      .grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; margin-top:10px; }
      @media (max-width: 960px){ .grid{ grid-template-columns: 1fr; } }
      .imgbox { background:#0c1528; border:1px solid #1f2a44; border-radius:10px; padding:8px; text-align:center; min-height:240px; display:flex; align-items:center; justify-content:center; }
      .imgbox img { max-width:100%; max-height:220px; object-fit:contain; border-radius:6px; }
      .code { background:#0c1528; border:1px solid #1f2a44; border-radius:10px; padding:12px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; white-space:pre; overflow:auto; max-height:320px; }
      .actions { display:flex; gap:8px; }
      #overlay { position:fixed; inset:0; background:rgba(11,18,32,.6); display:none; align-items:center; justify-content:center; z-index:10; }
      .spinner { width:48px; height:48px; border:4px solid #1f2a44; border-top-color:#4f8cff; border-radius:50%; animation:spin 1s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg) } }
      #heatmap-grid { overflow:auto; max-height:240px; }
      #meta-badges { display:flex; flex-wrap:wrap; gap:6px; }
    </style>
  </head>
  <body>
    <header>
      <h1>DeepForensics — Local Demo</h1>
      <div class="row">
        <span id="provider" class="chip">ML: stub</span>
        <span id="health" class="chip">health: —</span>
      </div>
    </header>
    <main>
      <section class="card">
        <h3 style="margin:0 0 8px 0;">Analyze a video</h3>
        <p class="muted">Your file never leaves your machine.</p>
        <form id="analyze-form" style="display:flex; flex-direction:column; gap:10px;">
          <input type="file" id="file" name="file" accept="video/*" required />
          <input type="text" id="device_id" placeholder="Optional device_id for enrolled PRNU" style="width:100%; background:#0c1528; color:#e6edf3; border:1px solid #1f2a44; border-radius:8px; padding:10px;" />
          <div class="row">
            <label><input type="checkbox" id="privacy" name="privacy_mode" checked /> privacy_mode</label>
          </div>
          <div class="actions">
            <button class="btn" type="submit" id="analyze-btn">Analyze</button>
            <button class="btn" type="button" id="download-json" disabled>Download JSON</button>
          </div>
          <div id="status" class="muted"></div>
        </form>
      </section>
      <section class="card">
        <h3 style="margin:0 0 8px 0;">Results</h3>
        <div class="stats">
          <div class="stat"><div class="k">Decision</div><div class="v" id="decision">—</div></div>
          <div class="stat"><div class="k">Ensemble score</div><div class="v" id="ens">—</div></div>
          <div class="stat"><div class="k">ML score</div><div class="v" id="ml">—</div></div>
        </div>
        <div style="margin-top:10px">
          <div class="muted">Confidence</div>
          <div style="height:10px; background:#0c1528; border:1px solid #1f2a44; border-radius:999px; overflow:hidden;">
            <div id="confbar" style="height:100%; width:0%; background:linear-gradient(90deg, #19c37d, #ffb020 50%, #ff5470 100%);"></div>
          </div>
        </div>
        <div style="margin-top:16px; padding:12px; background:#0c1528; border:1px solid #1f2a44; border-radius:10px;">
          <div class="muted" style="margin-bottom:8px;">AI Explanation</div>
          <div id="verdict" style="margin-bottom:8px; font-weight:700; font-size:16px; color:var(--accent);"></div>
          <div id="explanation" style="color:#e6edf3; line-height:1.6; font-size:14px;">—</div>
          <div id="key-findings" style="margin-top:10px;"></div>
          <div id="ml-confidence" style="margin-top:8px; font-size:12px; color:var(--muted);"></div>
        </div>
        <div style="margin-top:16px; padding:12px; background:#0c1528; border:1px solid #1f2a44; border-radius:10px;">
          <div class="muted" style="margin-bottom:8px;">Frame-by-Frame Analysis</div>
          <div id="frame-analysis" style="display:flex; flex-direction:column; gap:10px;"></div>
        </div>
        <div style="margin-top:10px">
          <span id="meta-badges"></span>
        </div>
        <div class="grid" style="margin-top:12px;">
          <div class="imgbox"><div class="muted">Heatmap</div><img id="heatmap" /></div>
          <div class="imgbox"><div class="muted">Residual</div><img id="residual" /></div>
          <div class="imgbox"><div class="muted">Frame</div><img id="frame1" /></div>
        </div>
        <div class="grid" id="heatmap-grid" style="margin-top:12px; grid-template-columns: repeat(3, 1fr);"></div>
        <div style="margin-top:12px">
          <div class="muted">Top face-region scores</div>
          <div id="faces" class="code"></div>
        </div>
        <!-- Full JSON removed from inline view; use Download JSON only -->
      </section>
    </main>
    <div id="overlay"><div class="spinner"></div></div>
    <script src="main.js"></script>
  </body>
  </html>


